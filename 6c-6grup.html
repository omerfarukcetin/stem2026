<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Zorlu G√ºvenlik Sistemi</title>
    <style>
        body {
            margin: 0; padding: 0;
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(to bottom, #2F4F4F, #008080);
            height: 100vh; overflow: hidden; user-select: none;
            color: white;
        }

        /* --- UI ELEMENTLERƒ∞ --- */
        #top-bar {
            position: absolute; top: 0; width: 100%; height: 60px;
            display: flex; justify-content: space-between; align-items: center;
            padding: 0 30px; box-sizing: border-box;
            z-index: 10; text-shadow: 2px 2px 4px black;
        }

        /* --- EKRANLAR --- */
        .screen {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            z-index: 5; transition: opacity 0.5s;
        }

        /* Giri≈ü Kutusu */
        .login-box {
            background: rgba(255, 255, 255, 0.9);
            padding: 40px; border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            text-align: center; width: 350px; color: black;
        }
        input {
            width: 90%; padding: 12px; margin: 10px 0;
            border: 2px solid #ccc; border-radius: 10px; text-align: center;
        }
        button {
            padding: 10px 30px; border-radius: 10px; background: #008080; color: white;
            border: none; cursor: pointer; font-size: 1.1rem; transition: 0.2s;
        }
        button:hover { transform: scale(1.05); }

        /* Face ID Kamera */
        #face-id {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; z-index: 99; display: none;
            align-items: center; justify-content: center; flex-direction: column;
        }
        #webcam {
            width: 300px; height: 400px; border: 4px solid #0f0; border-radius: 20px;
            transform: scaleX(-1); object-fit: cover;
        }
        .scan-line {
            position: absolute; width: 300px; height: 5px; background: #0f0;
            box-shadow: 0 0 15px #0f0; animation: scan 2s infinite;
        }
        @keyframes scan { 0% {margin-top: -200px;} 100% {margin-top: 200px;} }

        /* Oyun Se√ßimi */
        .game-card {
            background: white; color: black; padding: 20px; border-radius: 20px;
            cursor: pointer; width: 200px; text-align: center; margin: 10px;
            display: inline-block; transition: 0.3s;
        }
        .game-card:hover { transform: scale(1.1); background: #FFD700; }

        /* Oyun Aray√ºz√º */
        #game-screen { display: none; background: #111; cursor: crosshair; }
        #hud {
            position: absolute; top: 70px; width: 100%; text-align: center; pointer-events: none;
        }
        #pass-display {
            background: white; color: black; padding: 5px 20px; border-radius: 10px;
            font-family: monospace; font-size: 1.5rem; font-weight: bold;
            border: 3px solid orange;
        }
        #stats {
            margin-top: 10px; font-size: 1.2rem; text-shadow: 1px 1px 2px black;
        }

        #finish-btn {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            padding: 15px 40px; background: orange; color: white; font-weight: bold;
            border: none; border-radius: 30px; cursor: pointer; font-size: 1.2rem;
        }

    </style>
</head>
<body>

    <div id="top-bar">
        <span id="date-display"></span>
        <span id="clock-display"></span>
    </div>

    <div id="face-id">
        <video id="webcam" autoplay playsinline muted></video>
        <div class="scan-line"></div>
        <h2 style="color:#0f0; margin-top:20px;">Kƒ∞MLƒ∞K TARANIYOR...</h2>
    </div>

    <div id="login-screen" class="screen">
        <div class="login-box">
            <h2>G√úVENLƒ∞K Sƒ∞STEMƒ∞</h2>
            <input type="email" id="email" placeholder="Gmail">
            <input type="text" id="pass" placeholder="≈ûifre (Min 5 hane)">
            <br><br>
            <button onclick="checkLogin()">Gƒ∞Rƒ∞≈û YAP</button>
            <p id="msg"></p>
        </div>
    </div>

    <div id="selection-screen" class="screen" style="display:none; background:rgba(0,0,0,0.9);">
        <h1>OYUN MODUNU SE√á</h1>
        <div>
            <div class="game-card" onclick="startGame(1)">
                <div style="font-size:3rem">üíÄüî´</div>
                <h3>ZOR Nƒ∞≈ûANCI</h3>
                <p>Sayƒ±lar saldƒ±rƒ±yor!</p>
            </div>
            <div class="game-card" onclick="startGame(2)">
                <div style="font-size:3rem">üé°üßΩ</div>
                <h3>S√úNGER BOB</h3>
                <p>Eƒülenceli Mod</p>
            </div>
        </div>
    </div>

    <div id="game-screen" class="screen">
        <div id="hud">
            <span id="pass-display">≈ûƒ∞FRE: </span>
            <div id="stats">Can: ‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è | Puan: 0</div>
        </div>
        <canvas id="canvas"></canvas>
        <button id="finish-btn" onclick="finishGame()">≈ûƒ∞FREYƒ∞ ONAYLA</button>
    </div>

    <script>
        // --- TEMEL AYARLAR ---
        setInterval(() => {
            document.getElementById('clock-display').innerText = new Date().toLocaleTimeString();
            document.getElementById('date-display').innerText = new Date().toLocaleDateString();
        }, 1000);

        let videoStream;
        async function startCam() {
            try {
                const video = document.getElementById('webcam');
                videoStream = await navigator.mediaDevices.getUserMedia({video: true});
                video.srcObject = videoStream;
            } catch(e) { console.log("Kamera yok"); }
        }

        function stopCam() {
            if(videoStream) videoStream.getTracks().forEach(t => t.stop());
        }

        // --- Gƒ∞Rƒ∞≈û ---
        async function checkLogin() {
            const pass = document.getElementById('pass').value;
            const email = document.getElementById('email').value;
            const msg = document.getElementById('msg');

            document.getElementById('face-id').style.display = 'flex';
            await startCam();

            setTimeout(() => {
                stopCam();
                document.getElementById('face-id').style.display = 'none';

                if(email.includes('@gmail.com') && pass.length >= 5) {
                    document.getElementById('login-screen').style.display = 'none';
                    document.getElementById('selection-screen').style.display = 'flex';
                } else {
                    document.body.style.background = 'red';
                    msg.innerText = "HATALI VEYA G√úVENSƒ∞Z!";
                    setTimeout(() => document.body.style.background = '#2F4F4F', 1000);
                }
            }, 2500);
        }

        // --- OYUN MOTORU ---
        let canvas = document.getElementById('canvas');
        let ctx = canvas.getContext('2d');
        let gameMode = 0;
        let generatedPassword = "";
        let mouseX = 0, mouseY = 0;
        let isMouseDown = false;
        
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        
        canvas.addEventListener('mousemove', e => { mouseX = e.clientX; mouseY = e.clientY; });
        canvas.addEventListener('mousedown', () => isMouseDown = true);
        canvas.addEventListener('mouseup', () => isMouseDown = false);

        // Deƒüi≈ükenler
        let enemies = [], bullets = [], particles = [];
        let score = 0, health = 3;
        let frame = 0;
        let difficulty = 1;

        // S√ºnger Bob Deƒüi≈ükenleri
        let wheel = {angle:0, spinning:false, speed:0, item:null};
        let gameState = "WHEEL";

        function startGame(mode) {
            gameMode = mode;
            document.getElementById('selection-screen').style.display = 'none';
            document.getElementById('game-screen').style.display = 'flex';
            
            generatedPassword = "";
            score = 0; 
            difficulty = 1;
            health = 3;
            enemies = [];
            bullets = [];
            
            if(mode === 2) initSpongebob();
            
            gameLoop();
        }

        // --- MOD 1: ZOR Nƒ∞≈ûANCI ---
        function updateShooter() {
            ctx.fillStyle = "#111"; ctx.fillRect(0,0,canvas.width, canvas.height);
            
            // Oyuncu (Silah)
            let gunX = mouseX;
            let gunY = canvas.height - 80;
            ctx.fillStyle = "cyan";
            ctx.font = "60px Arial";
            ctx.fillText("üî´", gunX - 30, gunY);

            // Ate≈ü Etme (Otomatik / Taramalƒ±)
            if(isMouseDown && frame % 5 === 0) { // Her 5 karede bir ate≈ü (Hƒ±zlƒ±)
                bullets.push({x: gunX - 5, y: gunY - 40, w: 10, h: 20, speed: 20});
            }

            // Mermiler
            ctx.fillStyle = "yellow";
            for(let i=bullets.length-1; i>=0; i--) {
                let b = bullets[i];
                b.y -= b.speed;
                ctx.fillRect(b.x, b.y, b.w, b.h);
                if(b.y < 0) bullets.splice(i, 1);
            }

            // D√º≈üman √úretimi (Zorluk arttƒ±k√ßa hƒ±zlanƒ±r)
            let spawnRate = Math.max(10, 60 - (difficulty * 5)); // 60'tan ba≈ülar, 10'a kadar d√º≈üer (√áƒ±lgƒ±n hƒ±z)
            if(frame % Math.floor(spawnRate) === 0) {
                let chars = "0123456789!?#%";
                enemies.push({
                    x: Math.random() * (canvas.width - 50),
                    y: -50,
                    val: chars[Math.floor(Math.random() * chars.length)],
                    speed: 3 + Math.random() * difficulty, // Gittik√ße hƒ±zlanƒ±r
                    size: 40 + Math.random() * 20
                });
            }

            // D√º≈ümanlar
            for(let i=enemies.length-1; i>=0; i--) {
                let e = enemies[i];
                e.y += e.speed;
                
                ctx.fillStyle = "red";
                ctx.font = `bold ${e.size}px Courier New`;
                ctx.fillText(e.val, e.x, e.y);

                // √áarpƒ±≈üma: Mermi vs D√º≈üman
                for(let j=bullets.length-1; j>=0; j--) {
                    let b = bullets[j];
                    if(b.x > e.x - 20 && b.x < e.x + e.size && b.y < e.y && b.y > e.y - e.size) {
                        // Vuruldu
                        generatedPassword += e.val;
                        createParticles(e.x, e.y - 20, "red");
                        enemies.splice(i, 1);
                        bullets.splice(j, 1);
                        score++;
                        difficulty += 0.2; // Her vuru≈üta zorluk artar
                        updateUI();
                        return; // D√∂ng√ºy√º kƒ±r
                    }
                }

                // √áarpƒ±≈üma: D√º≈üman vs Oyuncu veya Alt Sƒ±nƒ±r
                if(e.y > canvas.height) {
                    enemies.splice(i, 1);
                    health--;
                    difficulty += 0.5; // Ceza olarak daha da zorla≈üƒ±r
                    updateUI();
                    ctx.fillStyle = "rgba(255,0,0,0.5)"; ctx.fillRect(0,0,canvas.width,canvas.height); // Kƒ±rmƒ±zƒ± ekran fla≈üƒ±
                    if(health <= 0) {
                        alert("OYUN Bƒ∞TTƒ∞! Kaybettin. Ba≈ütan Ba≈üla.");
                        location.reload();
                    }
                }
            }
        }

        // --- MOD 2: S√úNGER BOB ---
        function initSpongebob() {
             let chars = "ABC123XYZ";
             enemies = []; // Burada enemies kutularƒ± temsil edecek
             for(let i=0; i<5; i++) {
                 for(let j=0; j<8; j++) {
                     enemies.push({
                         x: 300 + j*80, y: 100 + i*80, w:60, h:60,
                         val: chars[Math.floor(Math.random()*chars.length)],
                         color: `hsl(${Math.random()*360},70%,50%)`
                     });
                 }
             }
             wheel.spinning = false;
        }

        function updateSpongebob() {
            ctx.fillStyle = "#87CEEB"; ctx.fillRect(0,0,canvas.width,canvas.height);
            
            // √áark √áizimi ve Mantƒ±ƒüƒ± (√ñzetlendi)
            if(gameState === "WHEEL") {
                ctx.save(); ctx.translate(150, canvas.height/2);
                if(wheel.spinning) {
                    wheel.angle += wheel.speed; wheel.speed *= 0.98;
                    if(wheel.speed < 0.01) { wheel.spinning = false; wheel.item = "üßΩ"; gameState = "AIM"; }
                }
                ctx.rotate(wheel.angle);
                ctx.fillStyle="orange"; ctx.beginPath(); ctx.arc(0,0,100,0,Math.PI*2); ctx.fill(); ctx.stroke();
                ctx.fillStyle="white"; ctx.font="40px Arial"; ctx.fillText("?", -15, 15);
                ctx.restore();
                if(!wheel.spinning) { ctx.fillStyle="white"; ctx.fillText("√áEVƒ∞RMEK ƒ∞√áƒ∞N TIKLA", 50, canvas.height/2 + 150); }
            }
            
            // Ni≈üan Alma ve Fƒ±rlatma
            if(gameState === "AIM") {
                ctx.font="50px Arial"; ctx.fillText("üßΩ", 50, canvas.height/2);
                let angle = Math.atan2(mouseY - canvas.height/2, mouseX - 50);
                
                // Hedef √áizgisi
                ctx.strokeStyle = "white"; ctx.beginPath(); ctx.moveTo(50, canvas.height/2); ctx.lineTo(mouseX, mouseY); ctx.stroke();
            }

            // Kutular
            for(let i=enemies.length-1; i>=0; i--) {
                let e = enemies[i];
                ctx.fillStyle = e.color; ctx.fillRect(e.x, e.y, e.w, e.h);
                ctx.fillStyle = "white"; ctx.font="30px Arial"; ctx.fillText(e.val, e.x+20, e.y+40);
            }

            // Mermiler (S√ºnger Bob)
            for(let i=bullets.length-1; i>=0; i--) {
                let b = bullets[i];
                b.x += b.vx; b.y += b.vy; b.vy += 0.5;
                ctx.font="40px Arial"; ctx.fillText(b.icon, b.x, b.y);

                for(let j=enemies.length-1; j>=0; j--) {
                    let e = enemies[j];
                    if(b.x > e.x && b.x < e.x+e.w && b.y > e.y && b.y < e.y+e.h) {
                        generatedPassword += e.val;
                        createParticles(e.x+30, e.y+30, e.color);
                        enemies.splice(j,1); bullets.splice(i,1); updateUI(); break;
                    }
                }
            }
        }

        // --- ORTAK Sƒ∞STEMLER ---
        function handleInput() {
            if(gameMode === 2) {
                if(gameState === "WHEEL" && !wheel.spinning) {
                    wheel.spinning = true; wheel.speed = 0.5 + Math.random();
                } else if(gameState === "AIM") {
                    let angle = Math.atan2(mouseY - canvas.height/2, mouseX - 50);
                    bullets.push({x:50, y:canvas.height/2, vx:Math.cos(angle)*25, vy:Math.sin(angle)*25, icon:"üßΩ"});
                    gameState = "WHEEL";
                }
            }
        }

        function createParticles(x, y, color) {
            for(let i=0; i<15; i++) {
                particles.push({x:x, y:y, vx:(Math.random()-0.5)*10, vy:(Math.random()-0.5)*10, life:1, color:color});
            }
        }

        function gameLoop() {
            frame++;
            if(gameMode === 1) updateShooter();
            else updateSpongebob();

            // Par√ßacƒ±klar
            for(let i=particles.length-1; i>=0; i--) {
                let p = particles[i];
                p.x += p.vx; p.y += p.vy; p.life -= 0.05;
                ctx.globalAlpha = p.life; ctx.fillStyle = p.color; ctx.fillRect(p.x, p.y, 5, 5);
                ctx.globalAlpha = 1;
                if(p.life <= 0) particles.splice(i,1);
            }

            requestAnimationFrame(gameLoop);
        }

        function updateUI() {
            document.getElementById('pass-display').innerText = "≈ûƒ∞FRE: " + generatedPassword;
            let hearts = ""; for(let i=0; i<health; i++) hearts += "‚ù§Ô∏è";
            document.getElementById('stats').innerText = `Can: ${hearts} | Puan: ${score}`;
        }

        function finishGame() {
            if(generatedPassword.length < 5) { alert("≈ûifre √ßok kƒ±sa! Oynamaya devam et."); return; }
            if(confirm("≈ûifre kopyalanƒ±p ƒ∞hlas Koleji sitesine gidilsin mi?")) {
                navigator.clipboard.writeText(generatedPassword);
                window.location.href = "https://www.ihlaskoleji.k12.tr";
            }
        }
        
        canvas.addEventListener('mousedown', handleInput);
    </script>
</body>
</html>